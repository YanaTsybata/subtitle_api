<!DOCTYPE html>
<html lang="ukr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Завантаження субтитрів</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
    
</head>
<body>
    <h1>Завантаження субтитрів</h1>
    <textarea id="subtitlesText" rows="10" cols="50" placeholder="Вставте вміст CSV-файлу сюди"></textarea>
    <br>
    <button onclick="uploadSubtitles()">Завантажити субтитри</button>
    <br>
    <h2>Навігація по субтитрах:</h2>
    <button onclick="showCurrentSubtitle()">Показати поточний субтитр</button>
    <button onclick="advanceSubtitle()">Перейти до наступного субтитру</button>
    <div id="subtitleDisplay"></div>
    <div id="result"></div>
    <script>
        function uploadSubtitles() {
            const subtitlesText = document.getElementById('subtitlesText').value;
            axios.post('/api/subtitles/upload', { data: subtitlesText })
                .then(response => {
                    document.getElementById('result').innerText = response.data.message;
                })
                .catch(error => {
                    document.getElementById('result').innerText = 'Помилка при завантаженні: ' + (error.response ? error.response.data.error : error.message);
                });
        }
        
        function showCurrentSubtitle() {
            axios.get('/api/subtitles/current')
                .then(response => {
                    const subtitle = response.data;
                    if (subtitle.text) {
                        document.getElementById('subtitleDisplay').innerText = `${subtitle.text} (${subtitle.start_time} - ${subtitle.end_time})`;
                    } else {
                        document.getElementById('subtitleDisplay').innerText = 'Немає доступних субтитрів';
                    }
                    document.getElementById('result').innerText = '';
                })
                .catch(error => {
                    document.getElementById('result').innerText = 'Помилка: ' + (error.response ? error.response.data.message : error.message);
                    document.getElementById('subtitleDisplay').innerText = '';
                });
        }
        
        function advanceSubtitle() {
            axios.post('/api/subtitles/advance')
                .then(response => {
                    if (response.data.text) {
                        document.getElementById('subtitleDisplay').innerText = `${response.data.text} (${response.data.start_time} - ${response.data.end_time})`;
                        document.getElementById('result').innerText = response.data.message;
                    } else {
                        document.getElementById('subtitleDisplay').innerText = '';
                        document.getElementById('result').innerText = response.data.message;
                    }
                })
                .catch(error => {
                    document.getElementById('result').innerText = 'Помилка: ' + (error.response ? error.response.data.message : error.message);
                    document.getElementById('subtitleDisplay').innerText = '';
                });
        }
        </script>
</body>
</html>